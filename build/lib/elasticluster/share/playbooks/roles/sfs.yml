---

- name: Slurm worker nodes Playbook
  hosts: all
  roles:
    - role: 'nis'
      NIS_MASTER: "{{groups.slurm_master[0]}}"
      when: '{{multiuser_cluster|default("true")|bool}}'
    - role: 'nfs-client'
      NFS_MOUNTS:
        - fs: '{{sfs_export_location}}'
          mountpoint: '/sfs'
    - role: autofs
    - slurm-worker


- name: Slurm submit nodes Playbook
  hosts: slurm_submit:slurm_client
  roles:
    - role: 'nis'
      NIS_MASTER: "{{groups.slurm_master[0]}}"
      when: '{{multiuser_cluster|default("true")|bool}}'
    - role: 'nfs-client'
      NFS_MOUNTS:
        - fs: '{{sfs_export_location}}'
          mountpoint: '/sfs'
    - role: autofs
    - slurm-client

